(()=>{"use strict";const e=window.wp.interactivity;function s(e,s){s.context.wporg.showcase.screenshot.shouldRetry=e}function t(e,s){s.context.wporg.showcase.screenshot.hasError=e}const o=async(e,o)=>{try{const t=await fetch(e);if(function(e){e.context.wporg.showcase.screenshot.attempts++}(o),t.redirected)s(!0,o);else if(200===t.status&&!t.redirected){const e=await t.blob(),a=new FileReader;a.onload=e=>{!function(e,s){s.context.wporg.showcase.screenshot.base64Image=e}(e.target.result,o)},a.readAsDataURL(e),s(!1,o)}}catch(e){t(!0,o),s(!1,o)}};(0,e.store)({effects:{wporg:{showcase:{screenshot:{init:async e=>{const{context:s}=e,{base64Image:a,isMShots:c,src:r}=s.wporg.showcase.screenshot;if(c&&!a){await o(r,e);const a=setInterval((async s=>{const{attempts:c,base64Image:n,shouldRetry:i}=s;i&&await o(r,e),c>=10&&(clearInterval(a),n||t(!0,e))}),2e3,s.wporg.showcase.screenshot)}},update:e=>{const{context:s,ref:t}=e,{alt:o,base64Image:a,hasError:c,isMShots:r}=s.wporg.showcase.screenshot;if(r)if(c){const e=t.querySelector("div");e.classList.remove("wporg-site-screenshot__loader"),e.classList.add("wporg-site-screenshot__error"),e.innerText=o,t.parentElement.classList.remove("has-loaded")}else if(a){const e=document.createElement("img");e.src=a,e.alt=o,t.replaceChildren(e),t.parentElement.classList.add("has-loaded")}}}}}}})})();